<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STATISTIKY - KANCELÃÅ˜ NADÄšJE</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <style>
        /* TvÃ© barvy a styly ze statistik */
        :root { --neon: #00f2ff; --dark: #0f172a; --gold: #ffd700; --points: #ff00ff; }
        body { background: var(--dark); color: white; font-family: sans-serif; padding: 15px; text-align: center; }
        .stat-card { background: rgba(255,255,255,0.03); border-radius: 25px; border: 1px solid rgba(0,242,255,0.15); margin-bottom: 30px; padding: 20px; }
        .stat-row { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); align-items: center; }
        .rank { font-weight: 900; width: 40px; text-align: left; }
        .name { flex-grow: 1; text-align: left; font-weight: bold; }
        .value { font-family: monospace; color: var(--neon); font-weight: bold; }
        .header-logo { max-width: 150px; margin: 20px 0; filter: drop-shadow(0 0 5px var(--neon)); }
        h2 { color: var(--points); font-size: 1.2em; text-transform: uppercase; }
    </style>
</head>
<body>

    <a href="index.html"><img src="IMG_8429.png" alt="Logo" class="header-logo"></a>
    
    <div class="stat-card">
        <h2>â­ INDEX NADÄšJE (CELKEM)</h2>
        <div id="leaderboard-total">NaÄÃ­tÃ¡m body...</div>
    </div>

    <div class="stat-card">
        <h2>ğŸ’° NEJVÄšTÅ Ã VÃHRY</h2>
        <div id="leaderboard-money">NaÄÃ­tÃ¡m vÃ½hry...</div>
    </div>

    <a href="index.html" style="color:var(--neon); text-decoration:none; font-weight:bold;">â† ZPÄšT NA SÃZKY</a>

    <script type="module">
        import { DBService } from './js/database.js';

        // NaÄtenÃ­ dat a vykreslenÃ­ tabulek
        DBService.getStats(stats => {
            renderTable('leaderboard-total', stats, 'celkoveBody', ' NB');
            renderTable('leaderboard-money', stats, 'vyhry', ' KÄ');
        });

        function renderTable(elementId, stats, property, unit) {
            const container = document.getElementById(elementId);
            container.innerHTML = "";

            // SeÅ™azenÃ­ hrÃ¡ÄÅ¯ podle hodnoty
            const sortedPlayers = Object.entries(stats)
                .map(([name, data]) => ({ name, value: data[property] || 0 }))
                .filter(p => p.value > 0)
                .sort((a, b) => b.value - a.value);

            if (sortedPlayers.length === 0) {
                container.innerHTML = "<div style='opacity:0.5'>ZatÃ­m Å¾Ã¡dnÃ¡ data</div>";
                return;
            }

            sortedPlayers.forEach((player, index) => {
                const rank = index + 1;
                const crown = rank === 1 ? 'ğŸ‘‘ ' : '';
                container.innerHTML += `
                    <div class="stat-row">
                        <span class="rank">${rank}.</span>
                        <span class="name">${crown}${player.name}</span>
                        <span class="value">${player.value}<small>${unit}</small></span>
                    </div>
                `;
            });
        }
    </script>
</body>
</html>
